# vLLM 统一服务环境变量配置

# =============================================================================
# GPU 配置
# =============================================================================
# 指定使用的 GPU 设备（逗号分隔）
CUDA_VISIBLE_DEVICES=0,1

# NVIDIA 容器运行时配置
NVIDIA_VISIBLE_DEVICES=all
NVIDIA_DRIVER_CAPABILITIES=compute,utility

# =============================================================================
# vLLM 服务配置
# =============================================================================
# 多进程方法
VLLM_WORKER_MULTIPROC_METHOD=spawn

# 日志级别
VLLM_LOGGING_LEVEL=INFO

# 服务主机 IP
VLLM_HOST_IP=0.0.0.0

# 禁用日志请求（减少日志量）
VLLM_DISABLE_LOG_REQUESTS=false

# =============================================================================
# Hugging Face 配置
# =============================================================================
# Hugging Face Token（用于访问私有模型）
HF_TOKEN=

# 缓存目录
HF_HOME=/app/cache/huggingface
TRANSFORMERS_CACHE=/app/cache/transformers
HF_HUB_CACHE=/app/cache/hub

# 模型下载源（可选：huggingface.co 或 hf-mirror.com）
HF_ENDPOINT=https://huggingface.co

# =============================================================================
# 模型配置
# =============================================================================
# Chat 模型配置
CHAT_MODEL_NAME=Qwen3-32B
CHAT_MODEL_PORT=8001
CHAT_GPU_MEMORY_UTILIZATION=0.7
CHAT_MAX_MODEL_LEN=32768
CHAT_TENSOR_PARALLEL_SIZE=2

# Embedding 模型配置
EMBEDDING_MODEL_NAME=bge-m3
EMBEDDING_MODEL_PORT=8002
EMBEDDING_GPU_MEMORY_UTILIZATION=0.15
EMBEDDING_MAX_MODEL_LEN=8192

# Rerank 模型配置
RERANK_MODEL_NAME=bge-reranker-v2-m3
RERANK_MODEL_PORT=8003
RERANK_GPU_MEMORY_UTILIZATION=0.15
RERANK_MAX_MODEL_LEN=8192

# 路由服务配置
ROUTER_PORT=8000
ROUTER_HEALTH_CHECK_INTERVAL=30
ROUTER_STARTUP_TIMEOUT=300

# =============================================================================
# 系统配置
# =============================================================================
# Python 配置
PYTHONUNBUFFERED=1
TOKENIZERS_PARALLELISM=false

# 内存配置
GPU_MEMORY_FRACTION_RESERVED=0.05
SWAP_SPACE=4GiB

# 缓存配置
ENABLE_PREFIX_CACHING=true
CACHE_DTYPE=auto
BLOCK_SIZE=16

# =============================================================================
# 监控和日志配置
# =============================================================================
# 日志配置
LOG_LEVEL=INFO
MAX_LOG_LEN=100
DISABLE_LOG_STATS=false

# 健康检查配置
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_RETRIES=3
HEALTH_CHECK_START_PERIOD=300

# =============================================================================
# 安全配置
# =============================================================================
# API 密钥（用于访问 vLLM 服务）
VLLM_API_KEY=token-abc123

# CORS 配置
CORS_ALLOWED_ORIGINS=*
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=*

# SSL 配置（可选）
SSL_KEYFILE=
SSL_CERTFILE=
SSL_CA_CERTS=

# =============================================================================
# 开发和调试配置
# =============================================================================
# 开发模式
DEVELOPMENT_MODE=false

# 调试配置
DEBUG=false
VERBOSE=false

# 性能分析
ENABLE_PROFILING=false
PROFILING_OUTPUT_DIR=/app/logs/profiling

# =============================================================================
# Docker 配置
# =============================================================================
# 容器重启策略
RESTART_POLICY=unless-stopped

# 资源限制
MEMORY_LIMIT=32G
CPU_LIMIT=16

# 网络配置
NETWORK_SUBNET=172.20.0.0/16

# =============================================================================
# 备份和恢复配置
# =============================================================================
# 备份目录
BACKUP_DIR=/app/backups

# 自动备份间隔（小时）
BACKUP_INTERVAL=24

# 备份保留天数
BACKUP_RETENTION_DAYS=7